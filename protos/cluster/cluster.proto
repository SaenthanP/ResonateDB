syntax = "proto3";

package cluster;
option go_package = "/cluster;cluster";


enum NodeState {
  ALIVE = 0;
  SUSPECT = 1;
  DEAD = 2;
}

message NodeUpdate {
  string address = 1;
  int64 incarnation=2;
  int64 piggyBackCount=3;
  NodeState state=4;
}

message Ack {
  string from = 1;
  map<string, NodeUpdate> updates=2;
}

message Ping {
  string from = 1;
  map<string, NodeUpdate> updates=2;
}

message PingReq{
  string from = 1;
  string target=2;
  map<string, NodeUpdate> updates=3;
}

service ClusterService{
    rpc PingNode(Ping) returns (Ack);
    rpc PingReqNode(PingReq)returns (Ack);
}